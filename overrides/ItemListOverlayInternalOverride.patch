1c1
< package mezz.jei.gui;
---
> package code.elix_x.mods.fei.client.jeioverride;
3d2
< import javax.annotation.Nullable;
7d5
< import java.util.Arrays;
11a10,11
> import javax.annotation.Nullable;
> 
12a13,16
> 
> import code.elix_x.mods.fei.ForeverEnoughItemsBase;
> import code.elix_x.mods.fei.config.FEIConfiguration;
> import code.elix_x.mods.fei.net.FEIGiveItemStackPacket;
16d19
< import mezz.jei.api.gui.IDrawable;
19,20c22,25
< import mezz.jei.config.Constants;
< import mezz.jei.config.JEIModConfigGui;
---
> import mezz.jei.gui.GuiProperties;
> import mezz.jei.gui.ItemListOverlay;
> import mezz.jei.gui.ItemListOverlayInternal;
> import mezz.jei.gui.TooltipRenderer;
31d35
< import mezz.jei.network.packets.PacketJei;
45,48d48
< import net.minecraft.util.ResourceLocation;
< import net.minecraft.util.text.TextFormatting;
< import net.minecraftforge.fml.client.config.HoverChecker;
< import org.lwjgl.input.Keyboard;
50c50
< public class ItemListOverlayInternal implements IShowsRecipeFocuses, IMouseHandler {
---
> public class ItemListOverlayInternalOverride extends ItemListOverlayInternal {
53d52
< 	private static final int searchHeight = 16;
67,70d65
< 	private final GuiButton configButton;
< 	private final IDrawable configButtonIcon;
< 	private final IDrawable configButtonCheatIcon;
< 	private final HoverChecker configButtonHoverChecker;
86c81,94
< 	public ItemListOverlayInternal(ItemListOverlay parent, IIngredientRegistry ingredientRegistry, GuiScreen guiScreen, GuiProperties guiProperties) {
---
> 	private boolean canGiveItems;
> 	private boolean canDeleteItems;
> 
> 	private int searchFieldWidth;
> 	private int searchFieldHeight;
> 
> 	public ItemListOverlayInternalOverride(ItemListOverlay parent, IIngredientRegistry ingredientRegistry, GuiScreen guiScreen, GuiProperties guiProperties, boolean canGiveItems, boolean canDeleteItems, int searchFieldWidth, int searchFieldHeight){
> 		super(parent, ingredientRegistry, guiScreen, guiProperties);
> 
> 		this.canGiveItems = canGiveItems;
> 		this.canDeleteItems = canDeleteItems;
> 		this.searchFieldWidth = searchFieldWidth;
> 		this.searchFieldHeight = searchFieldHeight;
> 
93c101
< 		if (!activeAdvancedGuiHandlers.isEmpty() && guiScreen instanceof GuiContainer) {
---
> 		if(!activeAdvancedGuiHandlers.isEmpty() && guiScreen instanceof GuiContainer){
96c104
< 		} else {
---
> 		} else{
100,101c108,109
< 		final int columns = getColumns(guiProperties);
< 		final int rows = getRows(guiProperties);
---
> 		final int columns = getColumns_(guiProperties);
> 		final int rows = getRows_(guiProperties);
118,119c126
< 		final int searchFieldY = guiProperties.getScreenHeight() - searchHeight - borderPadding - 2;
< 		final int searchFieldWidth;
---
> 		final int searchFieldY = guiProperties.getScreenHeight() - searchFieldHeight - borderPadding - 2;
121c128
< 		if (isSearchBarCentered(guiProperties)) {
---
> 		if(isSearchBarCentered(guiProperties)){
123,124c130
< 			searchFieldWidth = guiProperties.getGuiXSize() - buttonSize - 1;
< 		} else {
---
> 		} else{
126d131
< 			searchFieldWidth = rightEdge - leftEdge - buttonSize - 1;
130c135
< 		searchField = new GuiTextFieldFilter(0, fontRenderer, searchFieldX, searchFieldY, searchFieldWidth, searchHeight, parent.getItemFilter());
---
> 		searchField = new GuiTextFieldFilter(0, fontRenderer, searchFieldX, searchFieldY, searchFieldWidth, searchFieldHeight, parent.getItemFilter());
133,141d137
< 		int configButtonX = searchFieldX + searchFieldWidth + 1;
< 		int configButtonY = guiProperties.getScreenHeight() - buttonSize - borderPadding;
< 		configButton = new GuiButton(2, configButtonX, configButtonY, buttonSize, buttonSize, "");
< 		ResourceLocation configButtonIconLocation = new ResourceLocation(Constants.RESOURCE_DOMAIN, Constants.TEXTURE_RECIPE_BACKGROUND_PATH);
< 		GuiHelper guiHelper = Internal.getHelpers().getGuiHelper();
< 		configButtonIcon = guiHelper.createDrawable(configButtonIconLocation, 0, 166, 16, 16);
< 		configButtonCheatIcon = guiHelper.createDrawable(configButtonIconLocation, 16, 166, 16, 16);
< 		configButtonHoverChecker = new HoverChecker(configButton, 0);
< 
145,147c141,142
< 	private static boolean isSearchBarCentered(GuiProperties guiProperties) {
< 		return Config.isCenterSearchBarEnabled() &&
< 				guiProperties.getGuiTop() + guiProperties.getGuiYSize() + searchHeight < guiProperties.getScreenHeight();
---
> 	private static boolean isSearchBarCentered(GuiProperties guiProperties){
> 		return Config.isCenterSearchBarEnabled();
150c145
< 	private List<IAdvancedGuiHandler<?>> getActiveAdvancedGuiHandlers(GuiScreen guiScreen) {
---
> 	private List<IAdvancedGuiHandler<?>> getActiveAdvancedGuiHandlers(GuiScreen guiScreen){
152,153c147,148
< 		if (guiScreen instanceof GuiContainer) {
< 			for (IAdvancedGuiHandler<?> advancedGuiHandler : parent.getAdvancedGuiHandlers()) {
---
> 		if(guiScreen instanceof GuiContainer){
> 			for(IAdvancedGuiHandler<?> advancedGuiHandler : parent.getAdvancedGuiHandlers()){
155c150
< 				if (guiContainerClass.isInstance(guiScreen)) {
---
> 				if(guiContainerClass.isInstance(guiScreen)){
163c158
< 	private List<Rectangle> getGuiAreas(GuiContainer guiContainer) {
---
> 	private List<Rectangle> getGuiAreas(GuiContainer guiContainer){
165c160
< 		for (IAdvancedGuiHandler<?> advancedGuiHandler : activeAdvancedGuiHandlers) {
---
> 		for(IAdvancedGuiHandler<?> advancedGuiHandler : activeAdvancedGuiHandlers){
167c162
< 			if (guiExtraAreas != null) {
---
> 			if(guiExtraAreas != null){
175c170
< 	private <T extends GuiContainer> List<Rectangle> getGuiAreas(GuiContainer gui, IAdvancedGuiHandler<T> advancedGuiHandler) {
---
> 	private <T extends GuiContainer> List<Rectangle> getGuiAreas(GuiContainer gui, IAdvancedGuiHandler<T> advancedGuiHandler){
177c172
< 		if (guiClass.isInstance(gui)) {
---
> 		if(guiClass.isInstance(gui)){
184,185c179,180
< 	public boolean hasScreenChanged(GuiScreen guiScreen) {
< 		if (!Config.isOverlayEnabled()) {
---
> 	public boolean hasScreenChanged(GuiScreen guiScreen){
> 		if(!Config.isOverlayEnabled()){
189c184
< 		if (guiProperties == null) {
---
> 		if(guiProperties == null){
192c187
< 		if (!this.guiProperties.equals(guiProperties)) {
---
> 		if(!this.guiProperties.equals(guiProperties)){
194c189
< 		} else if (!activeAdvancedGuiHandlers.isEmpty() && guiScreen instanceof GuiContainer) {
---
> 		} else if(!activeAdvancedGuiHandlers.isEmpty() && guiScreen instanceof GuiContainer){
197c192
< 			if (!Java6Helper.equals(this.guiAreas, guiAreas)) {
---
> 			if(!Java6Helper.equals(this.guiAreas, guiAreas)){
205c200
< 	private static void createItemButtons(GuiIngredientFastList guiItemStacks, @Nullable List<Rectangle> guiAreas, final int xStart, final int yStart, final int columnCount, final int rowCount) {
---
> 	private static void createItemButtons(GuiIngredientFastList guiItemStacks, @Nullable List<Rectangle> guiAreas, final int xStart, final int yStart, final int columnCount, final int rowCount){
208c203
< 		for (int row = 0; row < rowCount; row++) {
---
> 		for(int row = 0; row < rowCount; row++){
210c205
< 			for (int column = 0; column < columnCount; column++) {
---
> 			for(int column = 0; column < columnCount; column++){
213c208
< 				if (guiAreas != null) {
---
> 				if(guiAreas != null){
215c210
< 					if (intersects(guiAreas, stackArea)) {
---
> 					if(intersects(guiAreas, stackArea)){
224,226c219,221
< 	private static boolean intersects(List<Rectangle> areas, Rectangle comparisonArea) {
< 		for (Rectangle area : areas) {
< 			if (area.intersects(comparisonArea)) {
---
> 	private static boolean intersects(List<Rectangle> areas, Rectangle comparisonArea){
> 		for(Rectangle area : areas){
> 			if(area.intersects(comparisonArea)){
247c242
< 	private void nextPage() {
---
> 	private void nextPage(){
249c244
< 		if (itemsCount == 0) {
---
> 		if(itemsCount == 0){
255c250
< 		if (firstItemIndex >= itemsCount) {
---
> 		if(firstItemIndex >= itemsCount){
261c256
< 	private void previousPage() {
---
> 	private void previousPage(){
263c258
< 		if (itemsPerPage == 0) {
---
> 		if(itemsPerPage == 0){
270c265
< 		if (pageNum == 0) {
---
> 		if(pageNum == 0){
272c267
< 		} else {
---
> 		} else{
277c272
< 		if (firstItemIndex > 0 && firstItemIndex == itemsCount) {
---
> 		if(firstItemIndex > 0 && firstItemIndex == itemsCount){
284c279
< 	public void drawScreen(Minecraft minecraft, int mouseX, int mouseY) {
---
> 	public void drawScreen(Minecraft minecraft, int mouseX, int mouseY){
292,295d286
< 		configButton.drawButton(minecraft, mouseX, mouseY);
< 
< 		IDrawable icon = Config.isCheatItemsEnabled() ? configButtonCheatIcon : configButtonIcon;
< 		icon.draw(minecraft, configButton.xPosition + 2, configButton.yPosition + 2);
299c290
< 		if (shouldShowDeleteItemTooltip(minecraft)) {
---
> 		if(shouldShowDeleteItemTooltip(minecraft)){
301c292
< 		} else {
---
> 		} else{
307c298
< 		if (!highlightedStacks.isEmpty()) {
---
> 		if(!highlightedStacks.isEmpty()){
309c300
< 			for (GuiIngredientFast guiItemStack : guiIngredientList.getAllGuiIngredients()) {
---
> 			for(GuiIngredientFast guiItemStack : guiIngredientList.getAllGuiIngredients()){
311,312c302,303
< 				if (ingredient instanceof ItemStack) {
< 					if (helper.containsStack(highlightedStacks, (ItemStack) ingredient) != null) {
---
> 				if(ingredient instanceof ItemStack){
> 					if(helper.containsStack(highlightedStacks, (ItemStack) ingredient) != null){
319c310
< 		if (hovered != null) {
---
> 		if(hovered != null){
326,327c317,318
< 	private boolean shouldShowDeleteItemTooltip(Minecraft minecraft) {
< 		if (Config.isDeleteItemsInCheatModeActive()) {
---
> 	private boolean shouldShowDeleteItemTooltip(Minecraft minecraft){
> 		if(canDeleteItems && FEIConfiguration.canDeleteItems(Minecraft.getMinecraft().player)){
336c327
< 	public void drawTooltips(Minecraft minecraft, int mouseX, int mouseY) {
---
> 	public void drawTooltips(Minecraft minecraft, int mouseX, int mouseY){
338c329
< 		if (mouseOver && shouldShowDeleteItemTooltip(minecraft)) {
---
> 		if(mouseOver && shouldShowDeleteItemTooltip(minecraft)){
343c334
< 		if (hovered != null) {
---
> 		if(hovered != null){
346,358d336
< 
< 		if (configButtonHoverChecker.checkHover(mouseX, mouseY)) {
< 			String configString = Translator.translateToLocal("jei.tooltip.config");
< 			if (Config.isCheatItemsEnabled()) {
< 				List<String> tooltip = Arrays.asList(
< 						configString,
< 						TextFormatting.RED + Translator.translateToLocal("jei.tooltip.cheat.mode")
< 				);
< 				TooltipRenderer.drawHoveringText(minecraft, tooltip, mouseX, mouseY);
< 			} else {
< 				TooltipRenderer.drawHoveringText(minecraft, configString, mouseX, mouseY);
< 			}
< 		}
361c339
< 	public void handleTick() {
---
> 	public void handleTick(){
366,369c344,346
< 	public boolean isMouseOver(int mouseX, int mouseY) {
< 		if (mouseX < guiProperties.getGuiLeft() + guiProperties.getGuiXSize()) {
< 			return isSearchBarCentered(guiProperties) &&
< 					(searchField.isMouseOver(mouseX, mouseY) || configButtonHoverChecker.checkHover(mouseX, mouseY));
---
> 	public boolean isMouseOver(int mouseX, int mouseY){
> 		if(mouseX < guiProperties.getGuiLeft() + guiProperties.getGuiXSize()){
> 			return isSearchBarCentered(guiProperties) && searchField.isMouseOver(mouseX, mouseY);
372,373c349,350
< 		for (Rectangle guiArea : guiAreas) {
< 			if (guiArea.contains(mouseX, mouseY)) {
---
> 		for(Rectangle guiArea : guiAreas){
> 			if(guiArea.contains(mouseX, mouseY)){
383,384c360,361
< 	public IClickedIngredient<?> getIngredientUnderMouse(int mouseX, int mouseY) {
< 		if (!isMouseOver(mouseX, mouseY)) {
---
> 	public IClickedIngredient<?> getIngredientUnderMouse(int mouseX, int mouseY){
> 		if(!isMouseOver(mouseX, mouseY)){
389c366
< 		if (clicked != null) {
---
> 		if(clicked != null){
397c374
< 	public boolean canSetFocusWithMouse() {
---
> 	public boolean canSetFocusWithMouse(){
402,403c379,380
< 	public boolean handleMouseClicked(int mouseX, int mouseY, int mouseButton) {
< 		if (!isMouseOver(mouseX, mouseY)) {
---
> 	public boolean handleMouseClicked(int mouseX, int mouseY, int mouseButton){
> 		if(!isMouseOver(mouseX, mouseY)){
408c385,395
< 		if (Config.isDeleteItemsInCheatModeActive()) {
---
> 		if(Minecraft.getMinecraft().player.inventory.getItemStack() == null){
>  			ClickedIngredient<?> f = guiIngredientList.getIngredientUnderMouse(mouseX, mouseY);
>  			if(f != null && f.getValue() instanceof ItemStack && canGiveItems && FEIConfiguration.canGiveItems(Minecraft.getMinecraft().player)){
>  				ItemStack itemstack = ((ItemStack) f.getValue()).copy();
>  				if(mouseButton == 0) itemstack.setCount(itemstack.getMaxStackSize());
>  				else itemstack.setCount(1);
>  				ForeverEnoughItemsBase.net.sendToServer(new FEIGiveItemStackPacket(itemstack));
>  				return true;
>  			}
>  		} else{
>  			if(canDeleteItems && FEIConfiguration.canDeleteItems(Minecraft.getMinecraft().player)){
412,414c399,401
< 			if (!itemStack.isEmpty()) {
< 				player.inventory.setItemStack(ItemStack.EMPTY);
< 				PacketJei packet = new PacketDeletePlayerItem(itemStack);
---
>  				if(itemStack != null){
>  					player.inventory.setItemStack(null);
>  					PacketDeletePlayerItem packet = new PacketDeletePlayerItem(itemStack);
417a405,407
>  			} else if(Minecraft.getMinecraft().player.isCreative()){
> 				return true;
> 			}
421c411
< 		if (buttonClicked) {
---
> 		if(buttonClicked){
430,431c420,421
< 	public boolean handleMouseScrolled(int mouseX, int mouseY, int scrollDelta) {
< 		if (!isMouseOver(mouseX, mouseY)) {
---
> 	public boolean handleMouseScrolled(int mouseX, int mouseY, int scrollDelta){
> 		if(!isMouseOver(mouseX, mouseY)){
434c424
< 		if (scrollDelta < 0) {
---
> 		if(scrollDelta < 0){
437c427
< 		} else if (scrollDelta > 0) {
---
> 		} else if(scrollDelta > 0){
444c434
< 	private boolean handleMouseClickedButtons(int mouseX, int mouseY) {
---
> 	private boolean handleMouseClickedButtons(int mouseX, int mouseY){
446c436
< 		if (nextButton.mousePressed(minecraft, mouseX, mouseY)) {
---
> 		if(nextButton.mousePressed(minecraft, mouseX, mouseY)){
450c440
< 		} else if (backButton.mousePressed(minecraft, mouseX, mouseY)) {
---
> 		} else if(backButton.mousePressed(minecraft, mouseX, mouseY)){
454,465d443
< 		} else if (configButton.mousePressed(minecraft, mouseX, mouseY)) {
< 			configButton.playPressSound(minecraft.getSoundHandler());
< 			if (Keyboard.getEventKeyState() && (Keyboard.getEventKey() == Keyboard.KEY_LCONTROL || Keyboard.getEventKey() == Keyboard.KEY_RCONTROL)) {
< 				Config.toggleCheatItemsEnabled();
< 			} else {
< 				if (minecraft.currentScreen != null) {
< 					parent.close();
< 					GuiScreen configScreen = new JEIModConfigGui(minecraft.currentScreen);
< 					minecraft.displayGuiScreen(configScreen);
< 				}
< 			}
< 			return true;
470c448
< 	private boolean handleMouseClickedSearch(int mouseX, int mouseY, int mouseButton) {
---
> 	private boolean handleMouseClickedSearch(int mouseX, int mouseY, int mouseButton){
473c451
< 		if (searchClicked && searchField.handleMouseClicked(mouseX, mouseY, mouseButton)) {
---
> 		if(searchClicked && searchField.handleMouseClicked(mouseX, mouseY, mouseButton)){
479c457
< 	public boolean hasKeyboardFocus() {
---
> 	public boolean hasKeyboardFocus(){
483,484c461,462
< 	public void setKeyboardFocus(boolean keyboardFocus) {
< 		searchField.setFocused(keyboardFocus);
---
> 	public void setKeyboardFocus(boolean keyboardFocus){
> 		if(searchField != null) searchField.setFocused(keyboardFocus);
487,488c465,466
< 	public boolean onKeyPressed(char typedChar, int keyCode) {
< 		if (hasKeyboardFocus()) {
---
> 	public boolean onKeyPressed(char typedChar, int keyCode){
> 		if(hasKeyboardFocus()){
502c480
< 	private static int getItemButtonXSpace(GuiProperties guiProperties) {
---
> 	private int getItemButtonXSpace(GuiProperties guiProperties){
506,510c484,485
< 	private static int getItemButtonYSpace(GuiProperties guiProperties) {
< 		if (isSearchBarCentered(guiProperties)) {
< 			return guiProperties.getScreenHeight() - (buttonSize + (3 * borderPadding));
< 		}
< 		return guiProperties.getScreenHeight() - (buttonSize + searchHeight + 2 + (4 * borderPadding));
---
> 	private int getItemButtonYSpace(GuiProperties guiProperties){
> 		return guiProperties.getScreenHeight() - (buttonSize + (isSearchBarCentered(guiProperties) ? 0 : (searchFieldHeight + 2)) + (4 * borderPadding));
513c488
< 	public static int getColumns(GuiProperties guiProperties) {
---
> 	public int getColumns_(GuiProperties guiProperties){
517c492
< 	public static int getRows(GuiProperties guiProperties) {
---
> 	public int getRows_(GuiProperties guiProperties){
521c496
< 	private int getPageCount() {
---
> 	private int getPageCount(){
524c499
< 		if (stacksPerPage == 0) {
---
> 		if(stacksPerPage == 0){
532c507
< 	private int getPageNum() {
---
> 	private int getPageNum(){
534c509
< 		if (stacksPerPage == 0) {
---
> 		if(stacksPerPage == 0){
540c515
< 	public void close() {
---
> 	public void close(){
546,547c521,522
< 	public ItemStack getStackUnderMouse() {
< 		if (hovered != null) {
---
> 	public ItemStack getStackUnderMouse(){
> 		if(hovered != null){
549c524
< 			if (ingredient instanceof ItemStack) {
---
> 			if(ingredient instanceof ItemStack){
556c531
< 	public void setFilterText(String filterText) {
---
> 	public void setFilterText(String filterText){
566c541
< 	public ImmutableList<ItemStack> getVisibleStacks() {
---
> 	public ImmutableList<ItemStack> getVisibleStacks(){
568c543
< 		for (GuiIngredientFast guiItemStack : guiIngredientList.getAllGuiIngredients()) {
---
> 		for(GuiIngredientFast guiItemStack : guiIngredientList.getAllGuiIngredients()){
570c545
< 			if (ingredient instanceof ItemStack) {
---
> 			if(ingredient instanceof ItemStack){
